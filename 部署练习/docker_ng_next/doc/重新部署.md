# é‡æ–°éƒ¨ç½²æŒ‡å—

ä¿®æ”¹ä»£ç åï¼Œæ ¹æ®ä¸åŒçš„ä¿®æ”¹ç±»å‹ï¼Œä½¿ç”¨ä¸åŒçš„é‡æ–°éƒ¨ç½²æ–¹æ³•ã€‚

## å¿«é€Ÿéƒ¨ç½²å‘½ä»¤ï¼ˆæ¨èï¼‰

æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼š

```bash
cd /Users/muliminty/project/demo/éƒ¨ç½²ç»ƒä¹ /docker_ng_next

# ä¸€é”®é‡æ–°éƒ¨ç½²ï¼ˆåœæ­¢ â†’ æ„å»º â†’ å¯åŠ¨ï¼‰
docker compose up -d --build
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
1. è‡ªåŠ¨æ£€æµ‹ä»£ç å˜åŒ–
2. é‡æ–°æ„å»ºé•œåƒ
3. åœæ­¢æ—§å®¹å™¨
4. å¯åŠ¨æ–°å®¹å™¨

## ä¸åŒåœºæ™¯çš„é‡æ–°éƒ¨ç½²

### æƒ…å†µ 1ï¼šä¿®æ”¹äº† Next.js ä»£ç ï¼ˆapp/ã€ç»„ä»¶ã€æ ·å¼ç­‰ï¼‰

éœ€è¦é‡æ–°æ„å»º Docker é•œåƒï¼š

```bash
# æ–¹å¼ 1ï¼šå®Œæ•´é‡æ–°éƒ¨ç½²ï¼ˆæ¨èï¼‰
docker compose down           # åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨ã€ç½‘ç»œã€å·ç­‰ï¼ˆæ¸…ç†ç¯å¢ƒï¼‰
docker compose build --no-cache   # é‡æ–°æ„å»ºé•œåƒï¼ˆä¸ä½¿ç”¨ç¼“å­˜ï¼Œç¡®ä¿æ‰€æœ‰æ›´æ”¹ç”Ÿæ•ˆï¼‰
docker compose up -d         # åå°å¯åŠ¨æ–°å®¹å™¨ï¼ˆä»¥æœ€æ–°é•œåƒè¿è¡ŒæœåŠ¡ï¼‰

# æ–¹å¼ 2ï¼šå¿«é€Ÿé‡æ–°éƒ¨ç½²ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
docker compose down
docker compose build
docker compose up -d

# æ–¹å¼ 3ï¼šä¸€è¡Œå‘½ä»¤ï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰
docker compose up -d --build
```

### æƒ…å†µ 2ï¼šåªä¿®æ”¹äº† Nginx é…ç½®ï¼ˆnginx/nginx.confï¼‰

æ— éœ€é‡æ–°æ„å»ºï¼Œåªéœ€é‡æ–°åŠ è½½é…ç½®ï¼š

```bash
# é‡æ–°åŠ è½½ Nginx é…ç½®ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰
docker compose exec nginx nginx -s reload

# æˆ–é‡å¯ Nginx å®¹å™¨
docker compose restart nginx
```

### æƒ…å†µ 3ï¼šä¿®æ”¹äº† docker-compose.yml

éœ€è¦é‡æ–°åˆ›å»ºå®¹å™¨ï¼š

```bash
docker compose down
docker compose up -d
```

## éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼ŒéªŒè¯æœåŠ¡çŠ¶æ€ï¼š

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—ï¼ˆç¡®è®¤æ²¡æœ‰é”™è¯¯ï¼‰
docker compose logs -f nextjs

# æµ‹è¯•è®¿é—®
curl http://localhost:4041
```

æˆ–åœ¨æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:4041`

## å¸¸ç”¨éƒ¨ç½²å‘½ä»¤å¯¹æ¯”

| å‘½ä»¤ | é€‚ç”¨åœºæ™¯ | é€Ÿåº¦ |
|------|---------|------|
| `docker compose up -d --build` | ä¿®æ”¹ä»£ç å | å¿«ï¼ˆæ¨èï¼‰ |
| `docker compose build --no-cache && docker compose up -d` | éœ€è¦å®Œå…¨é‡æ–°æ„å»º | æ…¢ |
| `docker compose restart nginx` | åªä¿®æ”¹ Nginx é…ç½® | æœ€å¿« |
| `docker compose down && docker compose up -d` | ä¿®æ”¹ docker-compose.yml | ä¸­ç­‰ |

## å¦‚æœé‡åˆ°é—®é¢˜

```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker compose logs nextjs
docker compose logs nginx

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps

# å¼ºåˆ¶é‡æ–°æ„å»ºï¼ˆæ¸…é™¤æ‰€æœ‰ç¼“å­˜ï¼‰
docker compose down
docker compose build --no-cache
docker compose up -d

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨
docker system prune -f
```

## å¿«é€Ÿè„šæœ¬

å¯ä»¥åˆ›å»ºä¸€ä¸ªå¿«é€Ÿéƒ¨ç½²è„šæœ¬ `deploy.sh`ï¼š

```bash
#!/bin/bash
cd /Users/muliminty/project/demo/éƒ¨ç½²ç»ƒä¹ /docker_ng_next
echo "ğŸ”„ é‡æ–°éƒ¨ç½²ä¸­..."
docker compose up -d --build
echo "âœ… éƒ¨ç½²å®Œæˆï¼"
docker compose ps
```

ç„¶åæ‰§è¡Œï¼š
```bash
chmod +x deploy.sh
./deploy.sh
```

**æ€»ç»“**ï¼šä¿®æ”¹ä»£ç åï¼Œæ‰§è¡Œ `docker compose up -d --build` å³å¯é‡æ–°éƒ¨ç½²ã€‚
